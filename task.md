# Current Task Context

## 今回やること・目的 (Goal/Objective)
<!-- 何のために何をするのか簡潔に記述 -->
- [ ] フロントエンドを React + TypeScript の SPA に完全移行し、既存機能をすべて同等以上の体験で提供する。
- [ ] 画面生成で Jinja テンプレートに依存しない構成へ移行し、UI のソースは React に一本化する。
- [ ] 既存の FastAPI の API 契約・挙動を壊さず、運用/デプロイの流れ（`static/spa/` 配信）を維持する。

## やること (Must)
<!-- 具体的なタスクリスト -->
- [ ] 現行 UI 機能の棚卸し（カレンダー、日別画面、ルーチン/ステップ、カスタムタスク、日報、チャット、モデル選択、評価フロー等）と移行対象の確定
- [ ] React(TypeScript) の技術基盤整備（`tsconfig.json`、Vite 設定、型チェック/ビルド/開発起動の整合）
- [ ] 既存 React(JS) 実装の TS 化（`.jsx` → `.tsx`）と型定義の整備（API レスポンス/ペイロード/ドメイン型）
- [ ] ルーティング設計（SPA ルート、URL と画面の対応、ディープリンク対応、戻る/進む履歴）
- [ ] API クライアント共通化（`fetch` ラッパー、エラー型、リトライ/中断、`proxy-prefix` 対応）
- [ ] 既存機能の UI パリティ実装（画面/操作/挙動/フラッシュ通知/ハイライト含む）
- [ ] 既存 HTML フォーム POST 依存の操作を SPA から実行可能にする（FormData 送信 or API 化方針決定）
- [ ] `templates/spa.html` を最小の SPA シェルに整理（`div#root`、`meta[name='proxy-prefix']` など必要要素のみ）
- [ ] ビルド成果物の配置・配信の維持（`static/spa/` への出力、FastAPI 側の配信パス維持）
- [ ] 既存ドキュメント更新（起動手順/環境変数/手動テスト項目）

## やらないこと (Non-goals)
<!-- 今回のスコープ外のこと -->
- [ ] 新機能の追加や UI の大幅な再設計（機能パリティ優先）
- [ ] バックエンドのビジネスロジック/DB スキーマの変更（必要最小限の API 追加は別途合意）
- [ ] LLM モデルやプロバイダの変更、推論ロジックの改変
- [ ] パフォーマンス最適化の大規模施策（移行後の別タスク）

## 受け入れ基準 (Acceptance Criteria)
<!-- 完了とみなす条件 -->
- [ ] `uvicorn app:app --reload --port 5000` で SPA が表示され、すべての主要画面が表示できる
- [ ] 既存の UI 機能がすべて SPA から操作可能（カレンダー移動、日別編集、ルーチン CRUD、カスタムタスク、日報、チャット、モデル選択、評価フロー）
- [ ] 既存 API と互換性があり、HTTP エラー時にユーザーへ適切に表示される
- [ ] TypeScript の型チェックが通る（`npm run build` 相当で失敗しない）
- [ ] `static/spa/` にビルド成果物が出力され、既存配信経路で動作する
- [ ] ブラウザコンソールに致命的エラーが出ない（初期表示/主要操作）

## 影響範囲 (Impact/Scope)
<!-- 変更するファイルや注意すべき既存機能 -->
- **触るファイル**:
  - `frontend/src/main.tsx`（分割/TS 化の中心）
  - `frontend/src/styles/app.css`（必要に応じて分割/整理）
  - `package.json` / `vite.config.js` / `tsconfig.json`（TS/ビルド設定）
  - `templates/spa.html`（SPA シェル化）
  - `app.py`（SPA ルート/配信設定の最小調整が必要な場合）
- **壊しちゃいけない挙動**:
  - カレンダー表示/移動、日別画面の進捗保存・日報保存
  - ルーチン/ステップの追加・削除・表示順
  - カスタムタスクの追加・削除・完了/メモ保存
  - チャット履歴・送信・応答、モデル選択反映
  - 評価フロー（seed/reset/log/history）と結果表示
